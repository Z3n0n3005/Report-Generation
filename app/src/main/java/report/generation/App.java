/*
 * This Java source file was generated by the Gradle 'init' task.
 */
package report.generation;

import java.io.IOException;

import opennlp.tools.util.StringList;
import report.generation.summarization.LSA;

public class App {
    static String projectPath = System.getProperty("user.dir");
    static String pdfPath = "../paper/automatic-text-summarization-a-comprehensive-survey.pdf";
    // static String pdfPath = "paper/abstractive-summarization-an-overview-of-the-state-of-the-art.pdf";
    static String pdfSegOutputPath = "../output/grobid-output.xml";
    static String yamlParseOutputPath = "../output/xml-parse-output.yaml";
    static SectionList sectionListAfterParse;

    public static void main(String[] args) throws IOException {
        
        System.out.println("[App] Start timing");
        System.out.println(projectPath);
        long startTime = System.nanoTime();

        // App.generateEngine();
        // App.pdfSegmenting();
        // App.parseXML();
        App.parseYAML();
        App.summarizeSegments();

        long endTime = System.nanoTime();
        double totalTime = (endTime - startTime)/1000000;
        System.out.println("[App] Time elapsed = " + totalTime);
    }

    private static void generateEngine(){
        long startTimeGenerateEngine = System.nanoTime();
        PdfSegmentation.generateEngine();
        long endTimeGenerateEngine = System.nanoTime();
        double engineGenerationTime = (endTimeGenerateEngine - startTimeGenerateEngine)/1000000;
        System.out.println("[App] Engine generation time: " + engineGenerationTime );
    }

    private static void abstractParsing(){
        long startTimeAbstractParse = System.nanoTime();
        String pdfAbstract = PdfSegmentation.parseHeader(pdfPath);
        Utility.printToFile(pdfAbstract, pdfSegOutputPath);
        long endTimeAbstractParse = System.nanoTime();
        double pdfHeaderParseTime = (endTimeAbstractParse - startTimeAbstractParse)/1000000;
        System.out.println("[App] First PDF Header parse time = " + pdfHeaderParseTime);
    }
    private static void pdfSegmenting(){
        long startTimePDFSeg = System.nanoTime();
        String pdfSegResult = PdfSegmentation.pdfSegmenting(pdfPath);
        Utility.printToFile(pdfSegResult, pdfSegOutputPath);
        long endTimePDFSeg = System.nanoTime();
        double pdfSegTime = (endTimePDFSeg - startTimePDFSeg)/1000000;
        System.out.println("[App] First PDF Segmentation time = " + pdfSegTime);
    }

    private static void parseXML(){
        long startTimeXMLParse = System.nanoTime();
        SectionList xmlParseResult = XMLParser.parseXML(pdfSegOutputPath);
        Utility.printToYamlFile(xmlParseResult, yamlParseOutputPath);
        long endTimeXMLParse = System.nanoTime();
        double xmlParseTime = (endTimeXMLParse - startTimeXMLParse)/1000000;
        System.out.println("[App] XML Parsing time = " + xmlParseTime);
    }

    private static void parseYAML(){
        long startTimeYAMLParse = System.nanoTime();
        sectionListAfterParse = YAMLParser.parseYAML(yamlParseOutputPath);
        long yamlParseEndTime = System.nanoTime();
        double yamlParseTime = (yamlParseEndTime - startTimeYAMLParse)/1000000;
        System.out.println("[App] YAML Parsing time = " + yamlParseTime);
    }

    private static void summarizeSegments() throws IOException{
        long startTimeSummarize = System.nanoTime();
        String temp = LSA.summarize(sectionListAfterParse.abstractSeg, 0);
        System.out.println(temp);
        long endTimeSummarize = System.nanoTime();
        double summarizeTime = (endTimeSummarize - startTimeSummarize)/1000000;
        System.out.println("[App] Summarization time = " + summarizeTime);
    }
}
