{
  "id": 4745456924619459755,
  "name": "block_diagonal_idiosyncratic_covariance_estimation.grobid.tei.xml",
  "segments": [
    {
      "header": "Introduction",
      "content": "under some reasonable assumptions, the asset return covariance under such a model is the sum of a common covariance component (which is low-rank, since the number of factors is much lower than the number of assets) and an idiosyncratic covariance component.\nsince these correlations are likely due to exposure to non-pervasive factors such as sectors, countries, or asset classes, ignoring these factors considerably reduces the performance of the estimators.in this paper we focus on the problem of structured estimation of the idiosyncratic covariance component in high-dimensional factor models, based on the assumption that the idiosyncratic correlations arise between assets exposed to some common but non-pervasive factors.\nsome of the early approaches based on high-dimensional factor models ensured positive definiteness by assuming a diagonal idiosyncratic covariance, which completely ignores the elements of risk arising from the correlations between the idiosyncratic components.\ncombining the high-dimensional factor structure and the assumption of sparsity of the idiosyncratic covariance (i.e. conditional sparsity) led to estimators such as the poetand s-poet, which were shown to produce estimates which perform well for some portfolio optimization use cases.\nhowever, the thresholding methods used in these estimators do not exploit any common structures in the idiosyncratic components, which are known to occur due to sector, asset class or other non-pervasive factor exposure.\nin this paper we use these structures to our advantage: by assuming that the idiosyncratic components exhibit correlations due to some group-specific factors such as asset class or sector classification, their covariance structure becomes block-diagonal.\nto allow for the latter and avoid any formerly mentioned obstacles, we focus on treating the cluster-specific dependencies as the idiosyncratic component of the covariance in the factor model.we develop a set of estimators which firstly calculate the low-rank common covariance component using principal components, and then use the residuals to estimate the unknown group memberships and the resulting block-diagonal idiosyncratic covariance.\nthis allows us to conduct a comprehensive study of the performance of different covariance estimators for high-dimensional factor models with a block-diagonal idiosyncratic covariance structure."
    },
    {
      "header": "Model",
      "content": "we consider the latent factor modelwhere b is a p \u00d7 k matrix of factor loadings, f is a k-dimensional random vector of k common factors and \u03b5 is a p-dimensional random vector of the specific factors, also known as the idiosyncratic component.\nthe factor loadings b, the factor realizations f and the idiosyncratic component \u03b5 are considered to be unobservable, so the factor model parameters need to be estimated from the observable asset returns.\nunder the model, the asset return covariance cov(y ) = \u03c3 has the following decomposition:where \u03c8 = cov(\u03b5) is the covariance of the specific factors, also known as the idiosyncratic covariance.the common covariance component bcov(f )b \u2032 is low-rank (since k < p), and explains the majority of the correlations between different assets as the result of their exposure to a smaller number of common factors.\nthe idiosyncratic covariance \u03c8 is often considered to be diagonal, however in this paper we consider models from the category of approximate factor models, where some sparse correlations between idiosyncratic components are allowed -thus the idiosyncratic covariance is full rank and sparse.\nmoreover, motivated by the documented grouping of financial assets (within industries or asset classes), we allow the idiosyncratic components of asset returns to be associated with one of a total of m clusters.\nthis means that (if the assets were sorted according to group membership) the idiosyncratic covariance has a block-diagonal structure.\nif the assets are sorted according to their cluster membership then the idiosyncratic covariance matrix has the following block-diagonal structure:where \u03c8 (cm) is the idiosyncratic covariance of all assets within cluster m.\nwe allow for the setting where the number of clusters m is large, even as large as or close to p (meaning that all assets belong to their own cluster, and that the resulting covariance matrix is diagonal).\nin order to be able to estimate and distinguish the factors from the idiosyncratic components, several assumptions are imposed on the spectrum of the asset return covariance."
    },
    {
      "header": "Estimation",
      "content": "apply a sparse estimation procedure to the residual covariance matrix, also known as the orthogonal complement:, in order to obtain a sparse estimate of \u03c8.it is important to note that the orthogonal complement s is a full matrix of rank min(n, t ) -k which does not serve as an idiosyncratic covariance estimate \u03c8 (since it is not a sparse matrix, nor a full-rank matrix).\nwhat this paper focuses on is the second step -the idiosyncratic covariance estimation, in the presence of clustered specific components, with an unknown clustering.the following sections lay out the elements of the estimation procedures for different important quantities.an important issue to deal with before we delve deeply into the specific of the estimators is the estimation of the number of factors k.\nthe idea is to apply generalized thresholding operator function f \u03c4ij to the full covariance s in order to obtain the sparse estimate \u03c8 \u03c4 :for any \u03c4 ij \u2265 0, the generalized thresholding operator is a function f \u03c4ij : r \u2192 r which, for all z \u2208 r satisfies the following conditions::these conditions are satisfied by several popular thresholding functions, out of which we consider the following:\u2022 hard thresholding :\u2022 soft thresholding:\u2022 adaptive lasso:\u2022 scad (smoothly clipped absolute deviation):the adaptive thresholding parameteris of the formwhere \u03c4 is a tuning parameter and \u03b8 ij are estimates ofthe parameter \u03c4 can be set as fixed or obtained through a data-driven cross-validation procedure.\nthis motivates the approach proposed in this paper -under the hypothesis that the idiosyncratic covariance reflect this grouping in the residual time series, we formulate a number of clustering based estimators.we denote the group membership information as a zero-one p \u00d7 p indicator matrix c (also known as a mask ), where the element c ij = 1 if i and j are in the same cluster group c m , for i, j \u2208 1, ..., p.\nthe imposed block-diagonal idiosyncratic covariance \u03c8 c which is obtained from the orthogonal complement s (the initial full idiosyncratic covariance estimate) is:where each block is defined as ( s cm = s ij 1 (ij)\u2208cm ), m \u2208 1, ...m , and \u2022 denotes the hadamard element-wise product.\nfor instance, when the dimension of a block c m (the number of time series in cluster m) is larger than the length of the time series estimation window t , some eigenvalues of the blockdiagonal idiosyncratic matrix estimate (and thus some of the eigenvalues of the entire covariance matrix estimate) are very close to zero (or exactly zero), resulting in the covariance matrix estimate which is not positive definite.\nthe resulting positive definite idiosyncratic covariance estimate isnow, the estimation of the idiosyncratic component as a block-diagonal matrix rests solely on the method employed to determine the blocks themselves -the structure of c.the simplest approach, which we lay out here as a benchmark, is to use pre-determined classifications or groupings of assets to formulate the clusters in the idiosyncratic component.\nto alleviate these issues, we propose two clustering based methods to estimate the block-diagonal idiosyncratic covariance.a natural extension of the previous approaches based on industry classifications of stock data is to estimate the optimal groupings from the data.\nin this section we develop a procedure based on different clustering approaches to the orthogonal complement s, resulting in block-diagonal estimates \u03c8 of the idiosyncratic covariance.\nfinally, the blocks of the block-diagonal idiosyncratic covariance are given by the clusters estimated using this procedure.we label this clustering-shrinkage estimator based on k-means csk, the corresponding idiosyncratic estimates \u03c8 csk , and the entire covariance estimate \u03c3 csk .as a more flexible framework, we also develop an estimator based on hierarchical clustering.\nfinally, the blocks of the block-diagonal idiosyncratic covariance are given by the clusters estimated using this procedure.we label this clustering-shrinkage estimator based on the hierarchical clustering approach csh, the corresponding idiosyncratic estimates \u03c8 csh , and the entire covariance estimate \u03c3 csh .the hyperparameters of the two clustering approaches also need to be estimated -for k-means clustering this is directly the number of clusters, and for the hierarchical clustering algorithm this is the threshold at which the agglomerative tree is cut off.\nwhen using hierarchical clustering, search through the grid of distances l \u2208 [l 1 , l 2 , ..., lp] (where each distance is connected to specific number of clusters m), and when using k-means clustering, search through the grid of number of clusters m \u2208 [1, 2, ..., p].\u2022 the indicator matrix c is obtained simply as:\u2022 calculate the validation error err h \u03c6 , h = 1, ...h as the frobenius norm of the difference between the cluster based idiosyncratic covariance estimate from the train set \u03c8 c train-h and the full orthogonal complement from the test set s test-h :we consider the mean of h validation errors assigned to each hyperparameter (l in case of hierarchical and m in the case of k-means clustering):and iterate over a grid of possible values of the considered hyperparameters (in the case of hierarchical clustering we iterate over a grid \u03c6 = [l 1 , l 2 , ..., l p ] and in case of k-means clustering we iterate over a grid \u03c6 = [1, 2, ..., p])."
    },
    {
      "header": "Simulation data",
      "content": "to test the ability of the estimator to identify true patterns of a block-diagonal structure, we construct a simulation scenario which allows us to analyze the performance of the estimators with respect to a known population covariance matrix.\nthe resulting covariance matrix is \u03c3 = bcov(f )b \u2032 + \u03c8.without loss of generality, we assume that the factors have identity covariance, leaving all the variability to the factor loadings matrix b.\ncalculate the common covariance as bb \u2032 .we define data generating processes based on two different shapes of the idiosyncratic covariance.\nto construct the idiosyncratic covariance we first build the correlation matrix, which is then transformed into the covariance matrix.the full block-diagonal idiosyncratic covariance is constructed in the following way:1.\ncalculate the covariance matrix from the obtained correlation matrix and the idiosyncratic variances.the partial block-diagonal covariance is constructed using graphs:1.\nthis procedure will build a graph with a number of connected components -each component will correspond to a cluster, and ultimately, a block in the idiosyncratic covariance.\ncalculate the covariance matrix from the obtained correlation matrix and the idiosyncratic variances.we consider a collection of daily us stock returns from january 1995 to january 2017.\nall the stocks have sic sector identification.to determine the group membership in the csi estimator, we collect the standard industrial classification codes (sic) sector codes for the selected stocks.a most commonly used performance measure for determining the quality of matrix estimation is the frobenius norm of the error:however, it is generally a rough way to measure the covariance estimation quality.\nin the simulation scenario, the population idiosyncratic covariance is known and thus we are able to measure the accuracy of identifying the true non-zero and zero elements in the population idiosyncratic covariance.\nwe use several, most common classification performance measures to evaluate the ability of the proposed estimators to identify the true sparsity patterns: positive rate (tp), true negative rate (tn), accuracy (acc) and f1 score.\u2022 accuracy is simply the ratio of correctly identified elements to the total number of off-diagonal elements in the idiosyncratic covariance.\u2022 tp (recall) and tn are the ratios of the correctly classified positive (negative) elements to the total number of positive (negative) elements in the population matrix.\u2022 f1 is defined as the harmonic mean of recall and precision, where recall equals tp and precision is the ratio of classified true positives to the number of all predicted positives.moreover, we also consider clustering performance measures, since the population idiosyncratic covariance is considered to be block-diagonal.\nwe use the ri both in simulation data (with respect to the population idiosyncratic covariance) and historical data, where we use it to measure the similarity of different methods to the industry classification.in addition to the results reported for the mentioned performance measures, which are averaged over a large number of simulations, for the simulation data we also consider the number of simulations in which the proposed csh and csk estimators outperform the benchmarks.\nthe optimal portfolio weights for the minimum variance portfolio are then calculated by solving the following optimization problem:where \u03c3 is the covariance estimate of the asset returns and the term w \u2032 \u03c3w is the portfolio variance.to evaluate different estimators we first obtain the optimal portfolio w on a given estimation window using a covariance estimate \u03c3, then we calculate the out-of-sample portfolio risk, which we quantify as volatility (standard deviation of the returns):when using simulation data, the population covariance \u03c3 is known.\nportfolios are optimized using the estimates obtained from the generated time series, and \"out-of-sample\" portfolio risk is calculated by using the known population covariance \u03c3 in the expression.\nfor historical data, the population covariance is unknown thus the sample estimates \u03c3 s from a future holding period are used in expression-this corresponds to a backtesting approach where the optimized portfolios are held on a given future time period, and the realized risk of these portfolios is calculated."
    },
    {
      "header": "Results",
      "content": "for all the measures, we report the p-values results of the one sided pair sign tests, based on the number of experiments in which the csh (for the partial block-diagonal case) and the csk (for the full block-diagonal case) estimators outperformed all the other methods.for the partial block-diagonal case, the csh estimator is expected to outperform, which is confirmed in the results, and statistically significant (for higher-dimensional series in all cases and for lower-dimensional in most of the cases) -this is evidently due to the fact that the hierarchical clustering approach can better accommodate single assets as clusters and generally the different cluster sizes, while the k-means approach is well-suited for compact, uniform-sized clusters.\nin the full block-diagonal idiosyncratic covariance case, the csk estimator outperforms all the benchmark methods in all aspects, for both considered dimensionalities.\nmoreover, even though the csk estimator is expected to outperform the csh estimator on the full block-diagonal case, the performance of the hierarchical approach remains comparatively high and the differences are not as large.\nthe first reason for this is that the full block-diagonal case is much easier for both clustering based estimators.\nand the second reason lies in the fact that csh is more flexible and able to deal with both simulation cases very well, while the csk struggles in the partial block-diagonal case.it is important to note that for both the partial and full block-diagonal shapes, the lowerdimensional simulations for p = 300 represent a drastically easier task for the k-means approach (csk estimator).\nin both considered dimensionalities, we observe that the clustering based estimators consistently outperform the thresholding based estimators -however, in lower-dimensional case, the improvement is not as drastic and not as pervasive as in the higher-dimensional case.\nthe p-values of the paired sign test comparing the csh (for partial block-diagonal case) and csk (for full block-diagonal case) estimator with all other methods are given in parentheses (below each method compared to the csh or csk estimator).although we did not observe drastic structural differences, or differences in order of the estimators' performances, there are some differences in the behavior of the estimators when increasing the dimension.\nmoreover, the clustering based estimators also show a great level of stability as clustering procedures are much more robust in capturing the idiosyncratic groupings, while the thresholding based estimators only focus on high pairwise covariances, and might miss out on the other members of the groups -these properties of the estimators are also the reason behind the f1 and ri being much higher for clustering based methods in tablefor both shown dimensions.\nthe full block-diagonal case seems to be captured almost perfectly by both clustering based methods, while the scad methods evidently misses out on some elements with smaller correlations (due to tapering further away from the diagonal).\nfor the partial block-diagonal case larger clusters tends to be broken into smaller ones by the csk approach, and some small and single-asset clusters are combined into larger ones.\nthe csh estimator is shown to capture the clusters relatively well.we test the estimators on the historical data using a portfolio optimization approach -at each time step, the portfolios are constructed using the covariance estimated during the past 1 year of daily returns (a total of 252 data points) using the considered estimators.\nthe results show that the clustering based methods generally outperform the thresholding based estimators, with the exception of the soft thresholding estimator for the lower dimensional case."
    },
    {
      "header": "Conclusion",
      "content": "we consider the problem of estimating the covariance matrix of high-dimensional financial return time series, given an underlying latent factor model.\nwe formulate a unified approach to estimating the block-diagonal idiosyncratic covariance and consider several methods to obtain the unknown block structure (clusters).\nwe also propose an iterative crossvalidation procedure in the context of the squared error given the assumed latent factor model, and test the proposed approach on simulation data and historical return data.the simulation results show that the proposed clustering based estimators successfully recognize the true sparse idiosyncratic covariance patterns, while decreasing the optimized portfolio volatility.\na striking finding is that the groups identified by the proposed estimators seem to differ to a great extent from the industry classification, however the portfolio performance of the proposed estimators is on par with or even better than the industry based estimator csi.the results evidently affirm the basic research hypothesis of the paper -that estimating the sparse idiosyncratic covariance as a block-diagonal matrix improves upon the thresholding based approach.\nallowing the assets to form entire clusters dramatically enriches the space of idiosyncratic covariance estimates, and ultimately results in a more realistic model of the asset return dependence.\nwe also hope to inspire new research, especially in the area of modeling the hierarchical group structures and their effect on the idiosyncratic covariance in approximate factor models.denote with g the cluster group set in the hierarchy which contains the observations.\nthe constant term \u03c0 is consistent estimator of asymptotic variances of the sample block matrix entries s c scaled by \u221a t (size of the block) defined as:n i=j e it -\u0113i )(e jt -\u0113j ) -s ij 2where \u0113i is the sample average of the returns of stock i from the cluster block c.\nterm \u03c1 is consistent estimator of sum of asymptotic covariances of the shrinkage target entries with the block sample covariance entries scaled by \u221a t (size of the block) defined as:where\u03b7 jj,ij = 1 t m (e jt -\u0113j ) 2 -s jj \u00d7 (e it -\u0113i )(e jt -\u0113j ) -s ij (44and \u03b3 is a consistent estimator of misspecification of the (population) shrinkage target defined as:"
    }
  ]
}
