{
  "id": 6127367341434789394,
  "name": "portfolio_optimization.grobid.tei.xml",
  "segments": [
    {
      "header": "Introduction",
      "content": "they help not only in shaping optimal portfolios in the hope of reducing out-of-sample risk, but also in building more \"practical\" portfolios, in the sense that one could more easily convert theoretical weights into real investment.despite the extensive literature on exogenous constraints, there are still disparities between theory and practice.\nwe do this by proposing a two-stage optimisation framework for solving the general portfolio selection problem.\nmore specifically, the theoretical portfolio composition must be converted into holdings that may require integral lots, may incur different types of costs and may make use of non-trivial features such as leverage and margin accounts.\nour two-stage approach attempts to integrate these features into a single framework, and its flexibility makes it easier to adapt to different market conditions.\nwith regards to computational efficiency, the second stage is restricted to assets for which trading might occur, which often does not include the entire asset universe under consideration.in the second stage we convert portfolio weights into holdings by considering, among other features, lots, transaction costs, margin accounts and borrowing costs in short positions.\nmoreover, lots are inherently intertwined with transaction costs -a feasible portfolio division into valid integral lots of different assets depends directly on the portfolio value after the trades take place, i.e. after all costs are discounted.in literature, optimal weights, lots and transaction costs have been generally considered as part of a single model, which requires both sets of decision variables described above.\nwe have also observed other issues with single stage approaches, such as (i) having to impose arbitrary limits on the investable cash, (ii) having to solve nonlinear nonconvex models when rebalances are accounted for or (iii) having to balance conflicting objectives, such as, on top of the portfolio optimal criteria, investing as much of the available capital as possible while also spending as little as possible in transaction costs.in our approach, we deal with these issues separately by employing a goal-programming framework: in the second stage we minimise both the costs involved and the deviation between real and desired portfolio weights.\na us$1 million fund which wants to invest 6-7% of its capital in s&p500 must choose between an actual holding of 0 or 12.5%.compared to the standard literature in lots, our two-stage approach has a potential disadvantage: the optimal portfolio is chosen in the expanded feasible set of non-integral portfolios.has shown that, in general, the assets selected by the optimal solution of a model that considers lots may not be included in the set of assets selected if lots are not taken into account.\nnevertheless, within the framework there is no incompatibility in employing a first stage portfolio selection model that does account for lots, retrieving the optimal lot-constrained weights and then feeding them into the second stage, where other particularities, potentially not previously considered, might be taken into account.we present extensive computational experiments to validate our proposed framework.\nin section 2, we present our literature review, where we discuss models that include lots and transaction costs in depth."
    },
    {
      "header": "Literature review",
      "content": "the authors included lots, fixed and variable transaction costs, upper exposure bounds on individual assets and portfolio cardinality.\nthe authors showed the problem to be np-hard.considered a similar model with fixed costs, applicable if the transaction value is above a lower bound.introduced transaction costs in the form of a piecewise linear function, andincluded a constraint to model capital-gain taxation and proposed a specialised exact algorithm to solve the problem.compared cvar and mad models in the presence of these constraints, andextended the model to consider portfolio rebalancing and transaction costs, but without lots.proposed a two-stage approach where portfolio weights are selected with any portfolio selection model and then a mixed-integer programming (mip) problem is solved to approximate the target portfolio as well as possible.\nthe authors considered transaction costs, buy-in thresholds, exposure bounds, cardinality constraints and portfolio rebalancing, and the model can be easily extended to incorporate lots.\ndespite that, it is possible to include costs as discounts in the first stage, such as in the papers cited above, without any conflict with the second stage decision.there are different ways to model transaction costs as discounts in the future portfolio value.summarises them as (i) fixed costs, (ii) variable costs, represented as a proportion of the trade value and (iii) convex or concave piecewise linear costs, which can be employed in the simulation of taxes and liquidity.\nnevertheless, the second stage can also be extended to include the other cost functions (we leave that as future work).when accounted for in portfolio selection models, lots and transaction costs reshape and limit the feasible region of optimal portfolios.showed that optimal solutions to problems with and without lots may include different sets of assets.\ntransaction costs, however, were incorporated in this paper as discounts in the assets expected returns as opposed to, where costs are discounted from c.showed that a portfolio selection model with variable and fixed costs, represented by equation (1), is np-hard even if no lots are considered (if x i can be fractional).used a similar approach, but with lump taxes instead of variable transaction costs.\nin such cases it may happen that the portfolio produced may not be purchasable as it is possible that i\u2208n v i x i \u2265 c 0 > c -tc, so c 0 must be well defined.andwere the first to model lots in a relative formulation, but they did not include transaction costs.\nas transaction costs are not considered, the estimation of l i is based on an arbitrary value as the total portfolio value after trading is unknown.also investigated the portfolio rebalancing problem with an alternative absolute formulation based on holdings instead of weights, but without accounting for lots nor transaction costs.extended the relative formulation with lots to explicitly include piecewise-constant fixed transaction costs and dividends.\ntheir model takes into account fixed and variable costs as well as current portfolio holdings, and can be easily extended to include lots.let x i be the current holdings in asset i, with the total portfolio value prior to trading defined as i\u2208n v i x i + c."
    },
    {
      "header": "Key concepts of futures contracts",
      "content": "in this section we focus on how to account for these differences in our framework rather than introducing the concept of futures contract.\nfor a comprehensive overview of the mechanics of futures, we refer the reader to hull.there are three main operational differences when trading futures:(i) futures contracts have expiration dates, (ii) purchasing a futures contract does not incur ownership of the underlying assets, but a deposit in a margin account is required as guarantee for fulfilling contractual obligations, irrespective of the party promising to buy (long) or sell (short) the asset, (iii) positions held are leveraged since required margin accounts are usually a fraction of the underlying contract value.these differences affect not only the two stages of our approach, but also how data must be prepared.\nalso, since the true investment in futures is the amount deposited in the margin account, the returns of the continuous time series must be multiplied by the leverage level to account for the actual returns that would have been observed.\nalso, commonly, just before expiration the brokers \"cancel out\" most contracts by purchasing an equivalent long position for holders of short positions, and likewise by purchasing equivalent short positions for holders of long positions.\nfor future contracts, we model this by using the leverage level to relate weights with the amount to be deposited in the margin account.\na further issue is that in futures both long and short positions require a cash deposit, as opposed to equities, where shorting does not (theoretically) require any investment upfront, rather creating a debt towards the lender.\nwith regards to portfolio selection, while the portfolio weight associated with a short position in equities is negative, the weight associated with a short position in futures is positive.\nin practice, identical short and long positions in a futures contract represent the same positive proportion of the total portfolio.\nthe difference lies in how they contribute to the portfolio returns: as the weighted negative and positive leveraged futures returns for short/long positions respectively.as a general illustration, consider a contract worth $10,000 in gold.\nlet the required margin deposit be 20% of the contract value for both parties.\neven though the contract is not expiring today, the brokers transfer the difference from the margin account of b to the margin account of a.\nlikewise, a may optionally withdraw part of its margin account since it is above the required level, and make it available for investment in other assets.\nin practice, pre-expiry cash settlements occur often, hence, just prior to the second stage, we assume that the margin account in any currently held positions are maintained at the exact required level, with the excess being put into/taken from cash reserves.note that a had a $1,000 profit on a $2,000 investment, or a 50% return -5 times the 10% increase in contract value.\nthe returns are the same (albeit deleveraged), but the proportion held is negative instead of positive.the particularities of shorting in futures contracts are dealt with in both first and second stages.\nin section 6.6, we show an application of leveraged futures contracts in producing market neutral portfolios with potential for positive return."
    },
    {
      "header": "First stage: choosing optimal portfolio weights",
      "content": "asset b represents the interest rate applied when we hold a short position in cash, that is, when we borrow money from the bank.let:depending on which exogenous constraints are applicable to the problem at hand, binary variables z + i and z - i are not strictly necessary, although many commercial and open-source solvers automatically detect whether a binary variable can be removed during their presolve phase.in portfolio selection literature, the proportion invested in asset i is more often represented with a single variable w i , where w i > 0 means a long position and w i < 0 means a short position.\na single variable, however, prevents us from modelling certain classes of exogenous constraints, such shorting limitsor even short positions in futures.let \u03c1(w), where w = (w + 1 , w - 1 , .\nconstraints (17) ensure that an asset, if picked, cannot be held in both long and short positions at the same time.\ndepending on the choice of \u03c1(w), the specific formulation may require additional variables and constraints (i.e. minimising cvar).let \u03c4 -, \u03c4 + be the minimum and maximum proportions of c allowed in a collection of short positions in equities.\nin order to enforce such limits, we add the following constraint:with this definition, we replace constraints ()-() by:if \u03c4 + > 0, then it is possible to invest up to 1 + \u03c4 + in long positions.\nin this case, let \u03c4 = i\u2208n 1 w - i represent the actual short exposure in equities (as decided by the model itself).let \u03c5 -, \u03c5 + be the minimum and maximum proportions of 1 + \u03c4 allowed in a collection of short positions in futures.\nto enforce these limits, we add the following constraint:by defining these limits as relative to the total long exposure, we have that 0 \u2264 \u03c5 -\u2264 \u03c5 + \u2264 1.\nin this case, the portfolio must hold 50% of c in short positions in equities, 75% of c must be held in short positions in futures and another 75% must be held in long positions in any of the assets.risk-free assets generally behave as equities, with a slight difference: the asset representing a lend rate cannot be held in short positions, while the asset representing a borrow rate cannot be held in long positions.\nwe add the following constraints:let \u00b5 i be the expected return of asset i \u2208 n .\nif a given futures i has expected return 1% and leverage level equal to 5\u00d7, then effectively \u00b5 i = 5%.the following constraint enforces minimum expected portfolio return given a target return \u03bc:note that short positions in futures contribute negatively to the portfolio expected return.let l + , l -be the lower limits (0 \u2264 l + , l -) on the proportion invested in long/short positions in any asset if we choose to invest in that asset.\nlikewise, let u + , u -be the upper limits (0 \u2264 u + , u -) on the proportion invested in long/short positions in any asset.\nthe constraints that enforce these limits are given by:the limits above are applicable (by our choice) to all but the risk-free assets."
    },
    {
      "header": "Second stage: from optimal proportions to real trades",
      "content": "let us define the following decision variables:p the portfolio value after transaction costs are discounted, x i number of shares of asset i \u2208 n to be held, m i financial value to be invested in asset i \u2208 n , c amount to be invested in cash, g i fractional transaction costs associated with buying or selling asset i \u2208 n .we assume for simplicity that f i > 0 \u2200i \u2208 n .\nwe make use of the following decision variables: expressing deviations as financial values allows us to combine them with transaction costs into a single objective function.letbe the set of assets in n 1 for which we currently hold short positions.\nborrowing costs are generally defined as a predefined yearly rate to be paid proportionally to the time the contract was held, with a reference price as basis for the calculation (usually the closing price of the day before the contract was opened).\nsince borrowing costs are entirely based on a predefined rate, the contract reference price and the number of days since it started, it is possible to calculate prior to the optimisation how much we would pay if an individual shorting contract was closed.\n, j i be additional decision variables representing the borrowing costs paid in fully or partially closing contract j from asset i.\n, j i + 1, be auxiliary binary variables, such that:, that is, we either keep or increase our shorting position in i,, that is, if we close all contracts up to j -1, and partially or entirely close contract j.that is, if we close the entire shorting position in i.the second stage formulation with borrowing costs and no lots is defined as:subject to (33) -(41)constraint (54) calculates the discounted portfolio p with deducted borrowing costs.\nconstant u can be calculated as the maximum possible difference |x i -x i | (depending on w * i ).constraints ()-(), together with objective (53), calculate the borrowing costs to be paid per contract.let f j i = -be the proportion of the value of the short contract j from asset i to be paid in borrowing costs in case we fully close it."
    },
    {
      "header": "Computational experiments",
      "content": "we leave the evaluation of the two-stage framework with larger asset universes for future work, but we believe the current dataset represents a realistic scenario.the selected futures contracts are the following:\u2022 micro e-mini s&p500 futures, with a lot size of 5,\u2022 gold futures, with a lot size of 100,\u2022 mini vix futures, with a lot size of 100.we employ the 10-year us treasury bond (symbol tnx) return series as a synthetic asset representing the return on both lent and borrowed cash.apart from being part of the index at the time (with the exception of futures and cash), an asset is only considered eligible in a rebalance if there are at most 5% prices missing from the most recent historical series of 201 prices (200 returns).\nwith the expectation that the first stage weights are a good choice we observe with round lots a 1.05% drop in cagr, a 6% drop in the sharpe ratio and a 7% drop in the sortino ratio.on top of the other costs, borrowing costs are also applicable for the long/short experiments.\ntableshows statistics related to the number of trades, portfolio cardinality (number of assets with non-zero weights) and the computational time required to solve each of the 132 second-stage instances (those due to portfolio rebalances).\nthe long/short strategies had more diversified portfolios, more trades and required borrowing costs; yet in the worst case the second stage required only 1.16s to be solved to optimality.\nwith odd lots, the average total deviation (including all assets) was only 0.6% and 1.08% for long only and long/short strategies.\nwe observe around 250% and 200% average deviation for the long/short and long only strategies with round lots.\nwith a $10,000,000 investment, the average long/short total deviation with round lots drops to 0.41%.in the previous section, the computational time required to solve the second stage was negligible.\nfinally, the last set of columns shows optimality gaps statistics among the instances that are not solved within the time limit.as an illustration, among the long only experiments with round lots and u + = 0.25%, the 132 rebalances chose on average non-zero weights in 401 different assets.\nyet, all 396 rebalances (for three different values of u + , u -) were solved quickly, with an average of 2.8s for the largest instances and a worst case of 11.1s.\u2022 the long only experiments with both odd and round lots make use of general integer variables, but no binary variables for borrowing costs.\nthe long only results shown in the appendix also support this choice.table: woodside model results, decay in expected returns (when compared to lot-unconstrained first stage solutions) and computational time (with p \u03b1 as the \u03b1 th percentile).first stage in-sample portfolio and the woodside optimal or best solution.\nwhile this could theoretically result in an advantage for the second stage, we observed that in all experiments in this section, all instances had positive expected returns as optimal solutions.we display comparative results between woodside and the second stage in-sample solutions in table.\nwith odd lots, with a small initial investment of $100,000 the differences are minor: the second stage obtained expected returns that were on average 0.52% worse than those of woodside.\nas the initial investment increases, numerical errors appear more often while solving woodside: with $5 million, in 114 out of 131 successful rebalances the woodside solution was actually worse than that of the second stage.with round lots, however, we observe more benefits in using a single-stage approach.\nthis difference reduces gradually until, with $5 million, they become all smaller than 1%.from these results, we can conclude that there is clear a case where employing lots and costs in the first stage is advantageous, as observed in the round lots and small initial investment results in table."
    },
    {
      "header": "Managerial insights",
      "content": "in this section we discuss practical aspects and features not yet considered, and which could consist in future extensions of this framework.in a practical sense, current (live) asset prices are required for applying the second stage.\nan assumption we made implicitly is that, once a second stage decision is made, assets are to be traded at prices v i .\nin cases where solving the second stage requires a few seconds (or more), real trading prices might deviate from the expected, and which in extreme cases could render the suggested portfolio not directly investable.\nto mitigate this issue, one could (i) trade at the end of the day, which is generally less volatile and/or (ii) impose a penalty at the price used in the second stage (if we are expecting an asset to be bought, increase its current price by a factor).\nthere are three possible ways to tackle this: (i) by adding turnover constraints in the first stage, (ii) by limiting the size of trades that can be recommended in the second stage as a function of the investment size and volume or (iii) by adopting trading policies after the second stage.\na possible extension of the twostage approach is to make it multistage: within the next days, suggest trades in multiple days such that not only the final portfolio matches the recommended one as close as possible, but so do the temporary portfolios within the limits of liquid trades.also proposed a two-stage approach which uses relative variables in both stages.\nhowever some considerations under that approach could be adopted into the second stage, such as minimising the number of trades or the deviation not only per individual asset, but also per asset class."
    },
    {
      "header": "Conclusions",
      "content": "in this paper, we propose a two-stage approach with the goal of building portfolios that can be directly translated into real-world investment.\nthe main contribution of our paper is in providing a tool that more closely constructs directly investable portfolios, and we hope this approach helps in reducing the gap between computational financial decisions and actual investing.\nat this stage several real-world constraints, most previously proposed in literature, are applicable.\nin the second stage, we propose a goal-programming approach whose main decision variables are shares to be held for each asset.\nat this stage, we consider other real-world criteria which require an absolute formulation, such as lots and costs.\nanother novel contribution of this paper is in considering also borrowing costs for short positions.we present extensive computational results that discuss the second stage applicability.\nour results suggest that in most cases the benefits of employing a single stage with regards to a two-stage approach are somewhat marginal.\nregardless, whenever it is advantageous this single stage approach can be \"condensed\" into our proposed first stage as part of the complete two-stage framework.several research lines can be explored as future work, some of them have been mentioned in section 7."
    }
  ]
}
